Effect of Yikun Neiyi Wan on the expression of aromatase P450, COX-2, and ER related receptor in endometrial cells in vitro from patients with endometriosis. To investigate the effect of yikun neiyi wan (YKNYW) and gestrinone on the expression of aromatase P450 (P450arom), cyclo-oxygenase-2 (COX-2) and estrogen receptor (ER) in isolated ectopic and normal endometrial stroma cells in vitro.Digestion and serial filtration were used to isolate and culture the ectopic and eutopic endometrial cells from patients with chocolate cyst in virto. Transformation of the cell morphology was observed in a inverted microscope. The effect of YKNYW on the expression of aromatase P450, cyclo-oxygenase-2, estrogen receptor in cultured endometriosis cells were detected by immunohistochemical method.The expression levels of P450arom, COX-2 in glandular epithelium cells in vitro were decreased significantly by YKNYW compared with gestrinone (P < 0.05). ER expression in mesenchymal cells of endometriosis was increased by YKNYW in the large and medium dosage groups compared with gestrinone.The mechanism by which YKNYW alleviates endometriosis pain is possibly related to the decrease in ectopic endometrial P450 arom and COX-2 expression in glandular epithelium, contrary to gestrinone, and the increase in ER expression in mesenchymalis, consistent with gestrione in patients with endometriosis.