Photon propagation and detection in single-photon emission computed tomography--an analytical approach. An analytical theory of photon propagation and detection in single-photon emission computed tomography (SPECT) for collimated detectors is developed from first principles. The total photon detection kernel is expressed as a sum of terms due to the primary and the Compton scattered photons. The primary as well as contributions due to every order of Compton scattering are calculated separately. The model accounts for the three-dimensional depth dependence of the collimator holes as well as for nonhomogeneous attenuation. No specific assumptions about the boundary or the homogeneity of the attenuating medium are made. The energy response of the detector is also modeled by the theory. Analytical expressions are obtained for various contributions to the photon detection kernel, and the multidimensional integrals involved are calculated using standard numerical integration methods. Theoretically calculated projections and scatter fractions for the primary and the first through second scattering orders are compared with our own experimental results for a small cylindrical primary radiation source immersed at various positions in a uniform cylindrical phantom. Also, theoretically calculated scatter fractions for a small spherical (pointlike) source in a uniform elliptic phantom are compared with experimental and Monte Carlo simulation results taken from the recent literature. The results from the analytical method are essentially exact and are free from the inaccuracies inherent in the numerical simulation methods used to deal with the photon propagation and detection problem in SPECT so far. The method developed here is unique in the sense that it provides accurate theoretical predictions of results averaged over an infinite number of simulations or experiments. We believe that our theory enhances an intuitive understanding of the complex image formation process in SPECT and is an important step toward solving the inverse problem, that of reconstructing the primary radiation source distribution from the measured gamma camera projections.