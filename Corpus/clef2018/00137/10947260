Inverse planning incorporating organ motion. Accurate targeting is important in intensity-modulated radiation therapy (IMRT). The positional uncertainties of structures with respect to the external beams arise in part from random organ motion and patient setup errors. While it is important to improve immobilization and reduce the influence of organ motion, the residual effects should be included in the IMRT plan design. Current inverse planning algorithms follow the conventional approach and include uncertainties by assuming population-based margins to the target and sensitive structures. Margin around a structure represents a "hard boundary" and the fact that a structure has a spatial probability distribution has been completely ignored. With increasing understanding of spatial uncertainties of structures and the technical capability of fine-tuning the dose distribution on an individual beamlet level in IMRT, it seems timely and important to fully utilize the information in the planning process. This will reduce the "effective" margins of the structures and facilitate dose escalation. Instead of specifying a "hard margin," we describe an inverse planning algorithm which takes into consideration positional uncertainty in terms of spatial probability distribution. The algorithm was demonstrated by assuming that the random organ motion can be represented by a three-dimensional Gaussian distribution function. Other probability distributions can be dealt with similarly. In particular, the commonly used "hard margin" is a special case of the current approach with a uniform probability distribution within a specified range. The algorithm was applied to plan treatment for a prostate case and a pancreatic case. The results were compared with those obtained by adding a margin to the clinical target volume. Better sparing of the sensitive structures were obtained in both cases using the proposed method for approximately the same target coverage.